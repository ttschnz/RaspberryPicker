#include <Arduino.h>
#include <avr/pgmspace.h>
#include "gaussian_pdf.h"

// const int elmnt_count = 1000;
// const float gaussian_pdf_table[elmnt_count] PROGMEM = {
//     // Paste values here generated by Python
//     0.00000149, 0.00000156, 0.00000164, 0.00000173, 0.00000181,
//     0.00000191, 0.00000200, 0.00000211, 0.00000221, 0.00000232,
//     0.00000244, 0.00000256, 0.00000269, 0.00000283, 0.00000297,
//     0.00000311, 0.00000327, 0.00000343, 0.00000360, 0.00000378,
//     0.00000397, 0.00000416, 0.00000436, 0.00000458, 0.00000480,
//     0.00000504, 0.00000528, 0.00000554, 0.00000580, 0.00000609,
//     0.00000638, 0.00000669, 0.00000701, 0.00000734, 0.00000769,
//     0.00000806, 0.00000844, 0.00000884, 0.00000926, 0.00000970,
//     0.00001016, 0.00001064, 0.00001114, 0.00001166, 0.00001220,
//     0.00001277, 0.00001337, 0.00001399, 0.00001464, 0.00001531,
//     0.00001602, 0.00001676, 0.00001753, 0.00001833, 0.00001917,
//     0.00002004, 0.00002095, 0.00002190, 0.00002290, 0.00002393,
//     0.00002501, 0.00002613, 0.00002731, 0.00002853, 0.00002980,
//     0.00003113, 0.00003251, 0.00003395, 0.00003546, 0.00003702,
//     0.00003865, 0.00004035, 0.00004212, 0.00004396, 0.00004588,
//     0.00004787, 0.00004995, 0.00005211, 0.00005436, 0.00005670,
//     0.00005914, 0.00006168, 0.00006432, 0.00006706, 0.00006991,
//     0.00007288, 0.00007597, 0.00007918, 0.00008252, 0.00008599,
//     0.00008959, 0.00009334, 0.00009723, 0.00010128, 0.00010549,
//     0.00010986, 0.00011439, 0.00011911, 0.00012400, 0.00012909,
//     0.00013437, 0.00013985, 0.00014554, 0.00015144, 0.00015757,
//     0.00016394, 0.00017054, 0.00017739, 0.00018449, 0.00019186,
//     0.00019951, 0.00020744, 0.00021566, 0.00022419, 0.00023303,
//     0.00024220, 0.00025170, 0.00026155, 0.00027175, 0.00028233,
//     0.00029328, 0.00030463, 0.00031639, 0.00032857, 0.00034119,
//     0.00035425, 0.00036778, 0.00038179, 0.00039629, 0.00041130,
//     0.00042683, 0.00044291, 0.00045954, 0.00047676, 0.00049457,
//     0.00051299, 0.00053204, 0.00055175, 0.00057213, 0.00059321,
//     0.00061500, 0.00063752, 0.00066081, 0.00068487, 0.00070974,
//     0.00073544, 0.00076200, 0.00078943, 0.00081777, 0.00084705,
//     0.00087728, 0.00090850, 0.00094074, 0.00097402, 0.00100838,
//     0.00104385, 0.00108046, 0.00111824, 0.00115722, 0.00119745,
//     0.00123895, 0.00128175, 0.00132591, 0.00137144, 0.00141840,
//     0.00146682, 0.00151674, 0.00156821, 0.00162125, 0.00167592,
//     0.00173227, 0.00179032, 0.00185014, 0.00191177, 0.00197525,
//     0.00204063, 0.00210797, 0.00217731, 0.00224870, 0.00232220,
//     0.00239787, 0.00247575, 0.00255591, 0.00263840, 0.00272328,
//     0.00281060, 0.00290044, 0.00299284, 0.00308789, 0.00318563,
//     0.00328613, 0.00338947, 0.00349570, 0.00360491, 0.00371715,
//     0.00383250, 0.00395104, 0.00407284, 0.00419797, 0.00432651,
//     0.00445854, 0.00459414, 0.00473338, 0.00487636, 0.00502316,
//     0.00517386, 0.00532854, 0.00548730, 0.00565022, 0.00581739,
//     0.00598892, 0.00616488, 0.00634538, 0.00653050, 0.00672035,
//     0.00691504, 0.00711464, 0.00731928, 0.00752904, 0.00774405,
//     0.00796439, 0.00819018, 0.00842153, 0.00865855, 0.00890135,
//     0.00915004, 0.00940473, 0.00966554, 0.00993260, 0.01020600,
//     0.01048589, 0.01077237, 0.01106556, 0.01136560, 0.01167260,
//     0.01198670, 0.01230801, 0.01263667, 0.01297281, 0.01331656,
//     0.01366804, 0.01402739, 0.01439475, 0.01477025, 0.01515403,
//     0.01554622, 0.01594696, 0.01635640, 0.01677466, 0.01720190,
//     0.01763825, 0.01808386, 0.01853887, 0.01900342, 0.01947766,
//     0.01996174, 0.02045579, 0.02095998, 0.02147444, 0.02199932,
//     0.02253477, 0.02308095, 0.02363799, 0.02420605, 0.02478528,
//     0.02537583, 0.02597784, 0.02659147, 0.02721687, 0.02785419,
//     0.02850357, 0.02916517, 0.02983914, 0.03052562, 0.03122477,
//     0.03193673, 0.03266165, 0.03339968, 0.03415096, 0.03491564,
//     0.03569387, 0.03648579, 0.03729154, 0.03811127, 0.03894511,
//     0.03979321, 0.04065571, 0.04153273, 0.04242443, 0.04333092,
//     0.04425236, 0.04518886, 0.04614055, 0.04710757, 0.04809003,
//     0.04908807, 0.05010179, 0.05113133, 0.05217680, 0.05323831,
//     0.05431597, 0.05540989, 0.05652018, 0.05764694, 0.05879028,
//     0.05995028, 0.06112704, 0.06232066, 0.06353122, 0.06475881,
//     0.06600350, 0.06726538, 0.06854451, 0.06984097, 0.07115482,
//     0.07248612, 0.07383493, 0.07520131, 0.07658529, 0.07798694,
//     0.07940627, 0.08084334, 0.08229817, 0.08377079, 0.08526121,
//     0.08676945, 0.08829553, 0.08983945, 0.09140120, 0.09298078,
//     0.09457819, 0.09619340, 0.09782639, 0.09947714, 0.10114560,
//     0.10283175, 0.10453553, 0.10625689, 0.10799577, 0.10975212,
//     0.11152585, 0.11331689, 0.11512516, 0.11695057, 0.11879301,
//     0.12065239, 0.12252860, 0.12442152, 0.12633102, 0.12825697,
//     0.13019924, 0.13215767, 0.13413213, 0.13612244, 0.13812845,
//     0.14014997, 0.14218683, 0.14423884, 0.14630581, 0.14838752,
//     0.15048378, 0.15259436, 0.15471903, 0.15685757, 0.15900974,
//     0.16117529, 0.16335395, 0.16554548, 0.16774961, 0.16996604,
//     0.17219451, 0.17443471, 0.17668636, 0.17894914, 0.18122274,
//     0.18350683, 0.18580110, 0.18810520, 0.19041879, 0.19274152,
//     0.19507304, 0.19741299, 0.19976098, 0.20211665, 0.20447960,
//     0.20684945, 0.20922581, 0.21160826, 0.21399639, 0.21638979,
//     0.21878804, 0.22119071, 0.22359735, 0.22600753, 0.22842080,
//     0.23083671, 0.23325480, 0.23567460, 0.23809565, 0.24051746,
//     0.24293957, 0.24536148, 0.24778271, 0.25020276, 0.25262113,
//     0.25503732, 0.25745082, 0.25986112, 0.26226771, 0.26467006,
//     0.26706766, 0.26945997, 0.27184647, 0.27422663, 0.27659992,
//     0.27896579, 0.28132370, 0.28367312, 0.28601350, 0.28834430,
//     0.29066496, 0.29297495, 0.29527370, 0.29756067, 0.29983531,
//     0.30209707, 0.30434539, 0.30657972, 0.30879952, 0.31100422,
//     0.31319328, 0.31536614, 0.31752226, 0.31966110, 0.32178209,
//     0.32388470, 0.32596839, 0.32803261, 0.33007683, 0.33210051,
//     0.33410312, 0.33608413, 0.33804301, 0.33997923, 0.34189229,
//     0.34378167, 0.34564685, 0.34748733, 0.34930261, 0.35109219,
//     0.35285558, 0.35459230, 0.35630186, 0.35798379, 0.35963762,
//     0.36126289, 0.36285915, 0.36442594, 0.36596283, 0.36746937,
//     0.36894515, 0.37038974, 0.37180273, 0.37318371, 0.37453229,
//     0.37584809, 0.37713072, 0.37837980, 0.37959499, 0.38077593,
//     0.38192226, 0.38303367, 0.38410982, 0.38515040, 0.38615511,
//     0.38712364, 0.38805572, 0.38895107, 0.38980942, 0.39063052,
//     0.39141413, 0.39216002, 0.39286796, 0.39353774, 0.39416917,
//     0.39476205, 0.39531622, 0.39583149, 0.39630773, 0.39674478,
//     0.39714252, 0.39750083, 0.39781959, 0.39809872, 0.39833813,
//     0.39853775, 0.39869751, 0.39881738, 0.39889731, 0.39893728,
//     0.39893728, 0.39889731, 0.39881738, 0.39869751, 0.39853775,
//     0.39833813, 0.39809872, 0.39781959, 0.39750083, 0.39714252,
//     0.39674478, 0.39630773, 0.39583149, 0.39531622, 0.39476205,
//     0.39416917, 0.39353774, 0.39286796, 0.39216002, 0.39141413,
//     0.39063052, 0.38980942, 0.38895107, 0.38805572, 0.38712364,
//     0.38615511, 0.38515040, 0.38410982, 0.38303367, 0.38192226,
//     0.38077593, 0.37959499, 0.37837980, 0.37713072, 0.37584809,
//     0.37453229, 0.37318371, 0.37180273, 0.37038974, 0.36894515,
//     0.36746937, 0.36596283, 0.36442594, 0.36285915, 0.36126289,
//     0.35963762, 0.35798379, 0.35630186, 0.35459230, 0.35285558,
//     0.35109219, 0.34930261, 0.34748733, 0.34564685, 0.34378167,
//     0.34189229, 0.33997923, 0.33804301, 0.33608413, 0.33410312,
//     0.33210051, 0.33007683, 0.32803261, 0.32596839, 0.32388470,
//     0.32178209, 0.31966110, 0.31752226, 0.31536614, 0.31319328,
//     0.31100422, 0.30879952, 0.30657972, 0.30434539, 0.30209707,
//     0.29983531, 0.29756067, 0.29527370, 0.29297495, 0.29066496,
//     0.28834430, 0.28601350, 0.28367312, 0.28132370, 0.27896579,
//     0.27659992, 0.27422663, 0.27184647, 0.26945997, 0.26706766,
//     0.26467006, 0.26226771, 0.25986112, 0.25745082, 0.25503732,
//     0.25262113, 0.25020276, 0.24778271, 0.24536148, 0.24293957,
//     0.24051746, 0.23809565, 0.23567460, 0.23325480, 0.23083671,
//     0.22842080, 0.22600753, 0.22359735, 0.22119071, 0.21878804,
//     0.21638979, 0.21399639, 0.21160826, 0.20922581, 0.20684945,
//     0.20447960, 0.20211665, 0.19976098, 0.19741299, 0.19507304,
//     0.19274152, 0.19041879, 0.18810520, 0.18580110, 0.18350683,
//     0.18122274, 0.17894914, 0.17668636, 0.17443471, 0.17219451,
//     0.16996604, 0.16774961, 0.16554548, 0.16335395, 0.16117529,
//     0.15900974, 0.15685757, 0.15471903, 0.15259436, 0.15048378,
//     0.14838752, 0.14630581, 0.14423884, 0.14218683, 0.14014997,
//     0.13812845, 0.13612244, 0.13413213, 0.13215767, 0.13019924,
//     0.12825697, 0.12633102, 0.12442152, 0.12252860, 0.12065239,
//     0.11879301, 0.11695057, 0.11512516, 0.11331689, 0.11152585,
//     0.10975212, 0.10799577, 0.10625689, 0.10453553, 0.10283175,
//     0.10114560, 0.09947714, 0.09782639, 0.09619340, 0.09457819,
//     0.09298078, 0.09140120, 0.08983945, 0.08829553, 0.08676945,
//     0.08526121, 0.08377079, 0.08229817, 0.08084334, 0.07940627,
//     0.07798694, 0.07658529, 0.07520131, 0.07383493, 0.07248612,
//     0.07115482, 0.06984097, 0.06854451, 0.06726538, 0.06600350,
//     0.06475881, 0.06353122, 0.06232066, 0.06112704, 0.05995028,
//     0.05879028, 0.05764694, 0.05652018, 0.05540989, 0.05431597,
//     0.05323831, 0.05217680, 0.05113133, 0.05010179, 0.04908807,
//     0.04809003, 0.04710757, 0.04614055, 0.04518886, 0.04425236,
//     0.04333092, 0.04242443, 0.04153273, 0.04065571, 0.03979321,
//     0.03894511, 0.03811127, 0.03729154, 0.03648579, 0.03569387,
//     0.03491564, 0.03415096, 0.03339968, 0.03266165, 0.03193673,
//     0.03122477, 0.03052562, 0.02983914, 0.02916517, 0.02850357,
//     0.02785419, 0.02721687, 0.02659147, 0.02597784, 0.02537583,
//     0.02478528, 0.02420605, 0.02363799, 0.02308095, 0.02253477,
//     0.02199932, 0.02147444, 0.02095998, 0.02045579, 0.01996174,
//     0.01947766, 0.01900342, 0.01853887, 0.01808386, 0.01763825,
//     0.01720190, 0.01677466, 0.01635640, 0.01594696, 0.01554622,
//     0.01515403, 0.01477025, 0.01439475, 0.01402739, 0.01366804,
//     0.01331656, 0.01297281, 0.01263667, 0.01230801, 0.01198670,
//     0.01167260, 0.01136560, 0.01106556, 0.01077237, 0.01048589,
//     0.01020600, 0.00993260, 0.00966554, 0.00940473, 0.00915004,
//     0.00890135, 0.00865855, 0.00842153, 0.00819018, 0.00796439,
//     0.00774405, 0.00752904, 0.00731928, 0.00711464, 0.00691504,
//     0.00672035, 0.00653050, 0.00634538, 0.00616488, 0.00598892,
//     0.00581739, 0.00565022, 0.00548730, 0.00532854, 0.00517386,
//     0.00502316, 0.00487636, 0.00473338, 0.00459414, 0.00445854,
//     0.00432651, 0.00419797, 0.00407284, 0.00395104, 0.00383250,
//     0.00371715, 0.00360491, 0.00349570, 0.00338947, 0.00328613,
//     0.00318563, 0.00308789, 0.00299284, 0.00290044, 0.00281060,
//     0.00272328, 0.00263840, 0.00255591, 0.00247575, 0.00239787,
//     0.00232220, 0.00224870, 0.00217731, 0.00210797, 0.00204063,
//     0.00197525, 0.00191177, 0.00185014, 0.00179032, 0.00173227,
//     0.00167592, 0.00162125, 0.00156821, 0.00151674, 0.00146682,
//     0.00141840, 0.00137144, 0.00132591, 0.00128175, 0.00123895,
//     0.00119745, 0.00115722, 0.00111824, 0.00108046, 0.00104385,
//     0.00100838, 0.00097402, 0.00094074, 0.00090850, 0.00087728,
//     0.00084705, 0.00081777, 0.00078943, 0.00076200, 0.00073544,
//     0.00070974, 0.00068487, 0.00066081, 0.00063752, 0.00061500,
//     0.00059321, 0.00057213, 0.00055175, 0.00053204, 0.00051299,
//     0.00049457, 0.00047676, 0.00045954, 0.00044291, 0.00042683,
//     0.00041130, 0.00039629, 0.00038179, 0.00036778, 0.00035425,
//     0.00034119, 0.00032857, 0.00031639, 0.00030463, 0.00029328,
//     0.00028233, 0.00027175, 0.00026155, 0.00025170, 0.00024220,
//     0.00023303, 0.00022419, 0.00021566, 0.00020744, 0.00019951,
//     0.00019186, 0.00018449, 0.00017739, 0.00017054, 0.00016394,
//     0.00015757, 0.00015144, 0.00014554, 0.00013985, 0.00013437,
//     0.00012909, 0.00012400, 0.00011911, 0.00011439, 0.00010986,
//     0.00010549, 0.00010128, 0.00009723, 0.00009334, 0.00008959,
//     0.00008599, 0.00008252, 0.00007918, 0.00007597, 0.00007288,
//     0.00006991, 0.00006706, 0.00006432, 0.00006168, 0.00005914,
//     0.00005670, 0.00005436, 0.00005211, 0.00004995, 0.00004787,
//     0.00004588, 0.00004396, 0.00004212, 0.00004035, 0.00003865,
//     0.00003702, 0.00003546, 0.00003395, 0.00003251, 0.00003113,
//     0.00002980, 0.00002853, 0.00002731, 0.00002613, 0.00002501,
//     0.00002393, 0.00002290, 0.00002190, 0.00002095, 0.00002004,
//     0.00001917, 0.00001833, 0.00001753, 0.00001676, 0.00001602,
//     0.00001531, 0.00001464, 0.00001399, 0.00001337, 0.00001277,
//     0.00001220, 0.00001166, 0.00001114, 0.00001064, 0.00001016,
//     0.00000970, 0.00000926, 0.00000884, 0.00000844, 0.00000806,
//     0.00000769, 0.00000734, 0.00000701, 0.00000669, 0.00000638,
//     0.00000609, 0.00000580, 0.00000554, 0.00000528, 0.00000504,
//     0.00000480, 0.00000458, 0.00000436, 0.00000416, 0.00000397,
//     0.00000378, 0.00000360, 0.00000343, 0.00000327, 0.00000311,
//     0.00000297, 0.00000283, 0.00000269, 0.00000256, 0.00000244,
//     0.00000232, 0.00000221, 0.00000211, 0.00000200, 0.00000191,
//     0.00000181, 0.00000173, 0.00000164, 0.00000156, 0.00000149,
// };

float gaussian_pdf_lookup(float z){
    // if (z < -5.0f || z > 5.0f) return 0.0f;

    // float step = 10.0f / (elmnt_count - 1);
    // int index = (int)((z + 5.0f) / step);

    // float val;
    // memcpy_P(&val, &gaussian_pdf_table[index], sizeof(float));

    return (1.0 / sqrt(2 * PI)) * pow(EULERS_NUMBER, -0.5 * z * z);
}
